!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1);document.getElementById("output").innerHTML="",r.IndexedClient.connect("example").then(function(e){const t=e.db;function n(n){const r=t.collection("another_collection");r.find(n).toArray().then(e=>{console.log(e),document.getElementById("output").innerHTML+=`<p>another_collection find {b : 2}: ${JSON.stringify(e)}</p>`}).then(()=>(document.getElementById("output").innerHTML+="<p>another_collection delete all {b : 2}</p>",r.deleteMany(n).then(e=>{document.getElementById("output").innerHTML+=`<p>${JSON.stringify(e)}</p>`}))).then(()=>{e.close()})}document.getElementById("output").innerHTML+=`<p>DB version: ${t.version}</p>`,1==t.version?Promise.all([t.createCollection("a_simple_collection").then(function(e){e.insertOne({a:1}).then(function(e){console.log("a_simple_collection",e),document.getElementById("output").innerHTML+=`<p>a_simple_collection: ${JSON.stringify(e)}</p>`})}),t.createCollection("another_collection").then(function(e){e.insertMany([{b:2},{c:3},{d:4},{b:2}]).then(function(e){console.log("another_collection",e),document.getElementById("output").innerHTML+=`<p>another_collection: ${JSON.stringify(e)}</p>`})})]).then(e=>{n({b:2})}):n({b:2})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.IndexedClient=class e{constructor(e){}close(e){return Promise.resolve(this.db.close())}static connect(t,n){const o=new e(t);return r.Db.open(t).then(e=>(o.db=e,o))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3);class o{constructor(e){this.idb=e,this.collectionQueue=new Set}static open(e,t){const n=self.indexedDB.open(e);return new Promise((e,t)=>{n.addEventListener("error",t),n.addEventListener("success",function(t){let r=new o(n.result);e(r)}),n.onblocked=(e=>{console.log("blocked")})})}get version(){return this.idb?this.idb.version:0}createCollection(e,t={autoIncrement:!0}){if(this.idb.objectStoreNames.contains(e))throw new Error("Collection already exists");if(!this.collectionQueue.size&&!this.DBOpenRequest){let e=this.version+1;this.idb.close(),this.DBOpenRequest=self.indexedDB.open(this.idb.name,e)}return this.collectionQueue.add(e),new Promise((n,o)=>{this.DBOpenRequest.addEventListener("error",o),this.DBOpenRequest.addEventListener("upgradeneeded",o=>{let s=this.DBOpenRequest.result;this.idb=s;const i=s.createObjectStore(e,t);i.transaction.addEventListener("complete",t=>{let o=new r.Collection(i,this.idb);this.collectionQueue.delete(e),n(o)})}),this.DBOpenRequest.onsuccess=(e=>{if(this.collectionQueue.size||!this.DBOpenRequest)throw new Error("Not all collections were created");this.DBOpenRequest=null})})}collection(e){const t=this.idb.transaction(e).objectStore(e);return new r.Collection(t,this.idb)}close(){this.idb.close()}}t.Db=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);t.Collection=class{constructor(e,t){this.store=e,this.idb=t}insertOne(e,t){return this.insertMany([e],t).then(e=>({insertedCount:1,insertedId:e.insertedIds[0]}))}insertMany(e,t){return new Promise((t,n)=>{let r=[],o=this.idb.transaction(this.store.name,"readwrite");o.oncomplete=(o=>{r.length===e.length?t({insertedCount:r.length,insertedIds:r}):n("No success")}),o.onerror=n;const s=o.objectStore(this.store.name);for(const t of e){const e=s.add(t);e.onerror=n,e.onsuccess=(t=>{r.push(e.result)})}})}getCursor(e,t=r.CursorOperation.READ){const n=t==r.CursorOperation.READ?"readonly":"readwrite",o=this.idb.transaction(this.store.name,n).objectStore(this.store.name);let s;return s=e?o.openCursor():o.getAll(),new r.Cursor(s,e,t)}find(e){return this.getCursor(e)}deleteMany(e,t){return this.getCursor(e,r.CursorOperation.DELETE).getResult().then(e=>({result:{ok:1,n:e.length},deletedCount:e.length}))}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.DELETE=0]="DELETE",e[e.UPDATE=1]="UPDATE",e[e.READ=2]="READ"}(r=t.CursorOperation||(t.CursorOperation={}));t.Cursor=class{constructor(e,t,n=r.READ){this.request=e,this.result=new Promise((r,o)=>{this.request.onerror=(e=>{o(this.request.error)}),this.request.onsuccess=(o=>{const s=e.result;if(s&&s instanceof IDBCursorWithValue)return this._result=this._result||[],this.executeCursorOperation(n,s,t),void s.continue();this._result=this._result||this.request.result,r(this._result)})})}applyFilter(e,t){let n=Object.keys(t);for(const r of n){if(r.startsWith("$"))return;if(e[r]!=t[r])return}return e}executeCursorOperation(e,t,n){const o=n?this.applyFilter(t.value,n):t.value;if(o)switch(this._result.push(o),e){case r.DELETE:t.delete();break;case r.UPDATE:}}getResult(){return this.result}toArray(){return this.result.then(e=>Array.from(e))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGUvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0luZGV4ZWRDbGllbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0RiLnRzIiwid2VicGFjazovLy8uL3NyYy9Db2xsZWN0aW9uLnRzIiwid2VicGFjazovLy8uL3NyYy9DdXJzb3IudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJJbmRleGVkQ2xpZW50XzEiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwiSW5kZXhlZENsaWVudCIsImNvbm5lY3QiLCJ0aGVuIiwiY2xpZW50IiwiZGIiLCJmaW5kIiwicSIsImNvbGxlY3Rpb24iLCJ0b0FycmF5IiwidmFsdWVzIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVNYW55IiwicmVzIiwiY2xvc2UiLCJ2ZXJzaW9uIiwiUHJvbWlzZSIsImFsbCIsImNyZWF0ZUNvbGxlY3Rpb24iLCJpbnNlcnRPbmUiLCJhIiwiaW5zZXJ0TWFueSIsImIiLCJEYl8xIiwiW29iamVjdCBPYmplY3RdIiwiZGJuYW1lIiwiZm9yY2UiLCJyZXNvbHZlIiwidGhpcyIsIm9wdGlvbnMiLCJEYiIsIm9wZW4iLCJDb2xsZWN0aW9uXzEiLCJpZGIiLCJjb2xsZWN0aW9uUXVldWUiLCJTZXQiLCJjb2xsZWN0aW9ucyIsIkRCT3BlblJlcXVlc3QiLCJzZWxmIiwiaW5kZXhlZERCIiwicmVqZWN0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicmVzdWx0Iiwib25ibG9ja2VkIiwiZSIsImF1dG9JbmNyZW1lbnQiLCJvYmplY3RTdG9yZU5hbWVzIiwiY29udGFpbnMiLCJFcnJvciIsInNpemUiLCJ2IiwiYWRkIiwic3RvcmUiLCJjcmVhdGVPYmplY3RTdG9yZSIsInRyYW5zYWN0aW9uIiwiQ29sbGVjdGlvbiIsImRlbGV0ZSIsIm9uc3VjY2VzcyIsIm9iamVjdFN0b3JlIiwiQ3Vyc29yXzEiLCJkb2NzIiwiaW5zZXJ0ZWRDb3VudCIsImluc2VydGVkSWQiLCJpbnNlcnRlZElkcyIsIm9uY29tcGxldGUiLCJsZW5ndGgiLCJvbmVycm9yIiwiZG9jIiwib2JqZWN0U3RvcmVSZXF1ZXN0IiwicHVzaCIsInF1ZXJ5Iiwib3BlcmF0aW9uIiwiQ3Vyc29yT3BlcmF0aW9uIiwiUkVBRCIsInJlcXVlc3QiLCJvcGVuQ3Vyc29yIiwiZ2V0QWxsIiwiQ3Vyc29yIiwiZ2V0Q3Vyc29yIiwiZmlsdGVyIiwiREVMRVRFIiwiZ2V0UmVzdWx0IiwiZGVsZXRlZCIsIm9rIiwiZGVsZXRlZENvdW50IiwiZXJyb3IiLCJjdXJzb3IiLCJJREJDdXJzb3JXaXRoVmFsdWUiLCJfcmVzdWx0IiwiZXhlY3V0ZUN1cnNvck9wZXJhdGlvbiIsImNvbnRpbnVlIiwiZmlsdGVyS2V5cyIsImtleXMiLCJzdGFydHNXaXRoIiwiYXBwbHlGaWx0ZXIiLCJVUERBVEUiLCJBcnJheSIsImZyb20iXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNB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b250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7SW5kZXhlZENsaWVudH0gZnJvbSBcIi4uL0luZGV4ZWRDbGllbnRcIjtcbmltcG9ydCB7RGJ9IGZyb20gXCIuLi9EYlwiO1xuLypcbi8vIENvbm5lY3QgdXNpbmcgTW9uZ29DbGllbnRcbk1vbmdvQ2xpZW50LmNvbm5lY3QodXJsLCBmdW5jdGlvbihlcnIsIGNsaWVudCkge1xuICAvLyBDcmVhdGUgYSBjb2xsZWN0aW9uIHdlIHdhbnQgdG8gZHJvcCBsYXRlclxuICBjb25zdCBjb2wgPSBjbGllbnQuZGIoZGJOYW1lKS5jb2xsZWN0aW9uKCdjcmVhdGVJbmRleEV4YW1wbGUxJyk7XG4gIC8vIFNob3cgdGhhdCBkdXBsaWNhdGUgcmVjb3JkcyBnb3QgZHJvcHBlZFxuICBjb2wuZmluZCh7fSkudG9BcnJheShmdW5jdGlvbihlcnIsIGl0ZW1zKSB7XG4gICAgdGVzdC5lcXVhbChudWxsLCBlcnIpO1xuICAgIHRlc3QuZXF1YWwoNCwgaXRlbXMubGVuZ3RoKTtcbiAgICBjbGllbnQuY2xvc2UoKTtcbiAgfSk7XG59KTtcbiogKi9cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3V0cHV0XCIpLmlubmVySFRNTCA9IFwiXCI7XG5JbmRleGVkQ2xpZW50LmNvbm5lY3QoXCJleGFtcGxlXCIpLnRoZW4oZnVuY3Rpb24gKGNsaWVudCkge1xuICAgIGNvbnN0IGRiID0gY2xpZW50LmRiIGFzIERiO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3V0cHV0XCIpLmlubmVySFRNTCArPSBgPHA+REIgdmVyc2lvbjogJHtkYi52ZXJzaW9ufTwvcD5gO1xuICAgIGlmIChkYi52ZXJzaW9uID09IDEpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgY29sbGVjdGlvblxuICAgICAgICBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICBkYi5jcmVhdGVDb2xsZWN0aW9uKFwiYV9zaW1wbGVfY29sbGVjdGlvblwiKS50aGVuKGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGEgZG9jdW1lbnQgaW4gdGhlIGNvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmluc2VydE9uZSh7YSA6IDF9KS50aGVuKGZ1bmN0aW9uIChyOiBhbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluaXNoIHVwIHRlc3RcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJhX3NpbXBsZV9jb2xsZWN0aW9uXCIsIHIpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm91dHB1dFwiKS5pbm5lckhUTUwgKz0gYDxwPmFfc2ltcGxlX2NvbGxlY3Rpb246ICR7SlNPTi5zdHJpbmdpZnkocil9PC9wPmA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGRiLmNyZWF0ZUNvbGxlY3Rpb24oXCJhbm90aGVyX2NvbGxlY3Rpb25cIikudGhlbihmdW5jdGlvbiAoY29sbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhIGRvY3VtZW50IGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5pbnNlcnRNYW55KFt7YiA6IDJ9LCB7YyA6IDN9LCB7ZCA6IDR9LCB7YiA6IDJ9XSkudGhlbihmdW5jdGlvbiAocjogYW55KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmlzaCB1cCB0ZXN0XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYW5vdGhlcl9jb2xsZWN0aW9uXCIsIHIpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm91dHB1dFwiKS5pbm5lckhUTUwgKz0gYDxwPmFub3RoZXJfY29sbGVjdGlvbjogJHtKU09OLnN0cmluZ2lmeShyKX08L3A+YDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXSkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgZmluZCh7YiA6IDJ9KVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBmaW5kKHtiIDogMn0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmluZCAocT86IGFueSkge1xuICAgICAgICBjb25zdCBjID0gZGIuY29sbGVjdGlvbihcImFub3RoZXJfY29sbGVjdGlvblwiKTtcbiAgICAgICAgYy5maW5kKHEpLnRvQXJyYXkoKS50aGVuKCh2YWx1ZXM6IGFueSkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2codmFsdWVzKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3V0cHV0XCIpLmlubmVySFRNTCArPSBgPHA+YW5vdGhlcl9jb2xsZWN0aW9uIGZpbmQge2IgOiAyfTogJHtKU09OLnN0cmluZ2lmeSh2YWx1ZXMpfTwvcD5gO1xuICAgICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3V0cHV0XCIpLmlubmVySFRNTCArPSBgPHA+YW5vdGhlcl9jb2xsZWN0aW9uIGRlbGV0ZSBhbGwge2IgOiAyfTwvcD5gO1xuICAgICAgICAgICAgcmV0dXJuIGMuZGVsZXRlTWFueShxKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdXRwdXRcIikuaW5uZXJIVE1MICs9IGA8cD4ke0pTT04uc3RyaW5naWZ5KHJlcyl9PC9wPmA7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNsaWVudC5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuIiwiaW1wb3J0IHtEYiwgSURifSBmcm9tIFwiLi9EYlwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIEluZGV4ZWRDbGllbnRPcHRpb25zIHtcbiAgICBjb2xsZWN0aW9ucz86IHN0cmluZ1tdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5kZXhlZE1vbmdvQ2xpZW50T3B0aW9ucyB7XG5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbmRleGVkTW9uZ29DbGllbnRTdGF0aWMge1xuICAgIC8vc3RhdGljIGNvbm5lY3QodXJpOiBzdHJpbmcsIG9wdGlvbnM/OiBNb25nb0NsaWVudE9wdGlvbnMpOiBQcm9taXNlPE1vbmdvQ2xpZW50PjtcbiAgICBjb25uZWN0ICh1cmk6IHN0cmluZywgb3B0aW9ucz86IEluZGV4ZWRNb25nb0NsaWVudE9wdGlvbnMpOiBQcm9taXNlPEluZGV4ZWRNb25nb0NsaWVudD5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbmRleGVkTW9uZ29DbGllbnQge1xuICAgIGRiOiBJRGI7XG5cbiAgICBjbG9zZSAoZm9yY2U/OiBib29sZWFuKTogUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNvbnN0IEluZGV4ZWRDbGllbnQ6IEluZGV4ZWRNb25nb0NsaWVudFN0YXRpYyA9IGNsYXNzIEluZGV4ZWRDbGllbnQgaW1wbGVtZW50cyBJbmRleGVkTW9uZ29DbGllbnQge1xuICAgIHB1YmxpYyBkYjogRGI7XG5cbiAgICBjb25zdHJ1Y3RvciAoZGJuYW1lOiBzdHJpbmcpIHtcbiAgICB9XG5cbiAgICBjbG9zZSAoZm9yY2U/OiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5kYi5jbG9zZSgpKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgY29ubmVjdCAobmFtZTogc3RyaW5nLCBvcHRpb25zPzogSW5kZXhlZENsaWVudE9wdGlvbnMpOiBQcm9taXNlPEluZGV4ZWRNb25nb0NsaWVudD4ge1xuICAgICAgICAvLyBJZiB0aGUgdmVyc2lvbiBpcyBub3QgcHJvdmlkZWQgYW5kIHRoZSBkYXRhYmFzZSBleGlzdHMsIHRoZW4gYSBjb25uZWN0aW9uIHRvIHRoZSBkYXRhYmFzZSB3aWxsIGJlIG9wZW5lZCB3aXRob3V0IGNoYW5naW5nIGl0cyB2ZXJzaW9uLiBJZiB0aGUgdmVyc2lvbiBpcyBub3QgcHJvdmlkZWQgYW5kIHRoZSBkYXRhYmFzZSBkb2VzIG5vdCBleGlzdCwgdGhlbiBpdCB3aWxsIGJlIGNyZWF0ZWQgd2l0aCB2ZXJzaW9uIDEuXG4gICAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBJbmRleGVkQ2xpZW50KG5hbWUpO1xuICAgICAgICByZXR1cm4gRGIub3BlbihuYW1lKS50aGVuKGRiID0+IHtcbiAgICAgICAgICAgIGNsaWVudC5kYiA9IGRiO1xuICAgICAgICAgICAgcmV0dXJuIGNsaWVudCBhcyBJbmRleGVkTW9uZ29DbGllbnQ7XG4gICAgICAgIH0pO1xuICAgIH1cblxufTsiLCJpbXBvcnQge0NvbGxlY3Rpb24sIENvbGxlY3Rpb25DcmVhdGVPcHRpb25zfSBmcm9tIFwiLi9Db2xsZWN0aW9uXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSURiIHtcbiAgICBjcmVhdGVDb2xsZWN0aW9uPFQ+IChuYW1lOiBzdHJpbmcsIG9wdGlvbnM/OiBDb2xsZWN0aW9uQ3JlYXRlT3B0aW9ucyk6IFByb21pc2U8Q29sbGVjdGlvbjxUPj47XG5cbiAgICBjb2xsZWN0aW9uPFQ+IChuYW1lOiBzdHJpbmcpOiBDb2xsZWN0aW9uPFQ+O1xufVxuXG5leHBvcnQgY2xhc3MgRGIgaW1wbGVtZW50cyBJRGIge1xuICAgIHByaXZhdGUgY29sbGVjdGlvblF1ZXVlOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIHByaXZhdGUgREJPcGVuUmVxdWVzdDogSURCT3BlbkRCUmVxdWVzdDtcblxuICAgIHN0YXRpYyBvcGVuIChuYW1lOiBzdHJpbmcsIGNvbGxlY3Rpb25zPzogc3RyaW5nW10pOiBQcm9taXNlPERiPiB7XG5cbiAgICAgICAgY29uc3QgREJPcGVuUmVxdWVzdCA9IHNlbGYuaW5kZXhlZERCLm9wZW4obmFtZSk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPERiPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgICAgICAgIC8vIHRoZXNlIHR3byBldmVudCBoYW5kbGVycyBhY3Qgb24gdGhlIGRhdGFiYXNlIGJlaW5nIG9wZW5lZFxuICAgICAgICAgICAgLy8gc3VjY2Vzc2Z1bGx5LCBvciBub3RcbiAgICAgICAgICAgIERCT3BlblJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCByZWplY3QpO1xuICAgICAgICAgICAgREJPcGVuUmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gc3RvcmUgdGhlIHJlc3VsdCBvZiBvcGVuaW5nIHRoZSBkYXRhYmFzZSBpbiB0aGUgZGJcbiAgICAgICAgICAgICAgICAvLyB2YXJpYWJsZS4gVGhpcyBpcyB1c2VkIGEgbG90IGxhdGVyIG9uLCBmb3Igb3BlbmluZ1xuICAgICAgICAgICAgICAgIC8vIHRyYW5zYWN0aW9ucyBhbmQgc3VjaGxpa2UuXG4gICAgICAgICAgICAgICAgbGV0IGRiID0gbmV3IERiKERCT3BlblJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgREJPcGVuUmVxdWVzdC5vbmJsb2NrZWQgPSAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdibG9ja2VkJylcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3RvciAocHJpdmF0ZSBpZGI6IElEQkRhdGFiYXNlKSB7XG4gICAgfVxuXG4gICAgZ2V0IHZlcnNpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZGIgPyB0aGlzLmlkYi52ZXJzaW9uIDogMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lXG4gICAgICogQHBhcmFtIG9wdGlvbnMgLSAgT3B0aW9uYWxcbiAgICAgKiBBbiBvcHRpb25zIG9iamVjdCB3aG9zZSBhdHRyaWJ1dGVzIGFyZSBvcHRpb25hbCBwYXJhbWV0ZXJzIHRvIHRoZSBtZXRob2QuIEl0IGluY2x1ZGVzIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAgICAgKiB8IEF0dHJpYnV0ZSAgICAgICAgICB8IERlc2NyaXB0aW9uICAgICAgIHxcbiAgICAgKiB8IC0tLS0tLS0tLS0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0gICB8XG4gICAgICogfCBrZXlQYXRoICAgICAgICAgIHwgVGhlIGtleSBwYXRoIHRvIGJlIHVzZWQgYnkgdGhlIG5ldyBvYmplY3Qgc3RvcmUuIElmIGVtcHR5IG9yIG5vdCBzcGVjaWZpZWQsIHRoZSBvYmplY3Qgc3RvcmUgaXMgY3JlYXRlZCB3aXRob3V0IGEga2V5IHBhdGggYW5kIHVzZXMgb3V0LW9mLWxpbmUga2V5cy4gWW91IGNhbiBhbHNvIHBhc3MgaW4gYW4gYXJyYXkgYXMgYSBrZXlQYXRoLiB8XG4gICAgICogfCBhdXRvSW5jcmVtZW50ICAgIHwgSWYgdHJ1ZSwgdGhlIG9iamVjdCBzdG9yZSBoYXMgYSBrZXkgZ2VuZXJhdG9yLiBEZWZhdWx0cyB0byBmYWxzZS4gfFxuICAgICAqIFVua25vd24gcGFyYW1ldGVycyBhcmUgaWdub3JlZC5cbiAgICAgKi9cbiAgICBjcmVhdGVDb2xsZWN0aW9uPFQ+IChuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IElEQk9iamVjdFN0b3JlUGFyYW1ldGVycyA9IHthdXRvSW5jcmVtZW50IDogdHJ1ZX0pOiBQcm9taXNlPENvbGxlY3Rpb248VD4+IHtcbiAgICAgICAgaWYgKHRoaXMuaWRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMobmFtZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvbGxlY3Rpb24gYWxyZWFkeSBleGlzdHNcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25RdWV1ZS5zaXplICYmICF0aGlzLkRCT3BlblJlcXVlc3QpIHtcbiAgICAgICAgICAgIGxldCB2ID0gdGhpcy52ZXJzaW9uICsgMTtcbiAgICAgICAgICAgIHRoaXMuaWRiLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLkRCT3BlblJlcXVlc3QgPSBzZWxmLmluZGV4ZWREQi5vcGVuKHRoaXMuaWRiLm5hbWUsIHYpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sbGVjdGlvblF1ZXVlLmFkZChuYW1lKTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPENvbGxlY3Rpb248VD4+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIC8vIHRoZXNlIHR3byBldmVudCBoYW5kbGVycyBhY3Qgb24gdGhlIGRhdGFiYXNlIGJlaW5nIG9wZW5lZFxuICAgICAgICAgICAgLy8gc3VjY2Vzc2Z1bGx5LCBvciBub3RcbiAgICAgICAgICAgIHRoaXMuREJPcGVuUmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIHJlamVjdCk7XG5cbiAgICAgICAgICAgIHRoaXMuREJPcGVuUmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCd1cGdyYWRlbmVlZGVkJywgZSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGRiOiBJREJEYXRhYmFzZSA9IHRoaXMuREJPcGVuUmVxdWVzdC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5pZGIgPSBkYjtcbiAgICAgICAgICAgICAgICAvL1RoaXMgbWV0aG9kIGNhbiBiZSBjYWxsZWQgb25seSB3aXRoaW4gYSB2ZXJzaW9uY2hhbmdlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgICAgIGNvbnN0IHN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUobmFtZSwgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgICAvLyBVc2UgdHJhbnNhY3Rpb24gb25jb21wbGV0ZSB0byBtYWtlIHN1cmUgdGhlIG9iamVjdFN0b3JlIGNyZWF0aW9uIGlzXG4gICAgICAgICAgICAgICAgLy8gZmluaXNoZWQgYmVmb3JlIGFkZGluZyBkYXRhIGludG8gaXQuXG4gICAgICAgICAgICAgICAgbGV0IHRyYW5zYWN0aW9uID0gc3RvcmUudHJhbnNhY3Rpb247XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbGxlY3Rpb24gPSBuZXcgQ29sbGVjdGlvbjxUPihzdG9yZSwgdGhpcy5pZGIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25RdWV1ZS5kZWxldGUobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY29sbGVjdGlvbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5EQk9wZW5SZXF1ZXN0Lm9uc3VjY2VzcyA9IGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jb2xsZWN0aW9uUXVldWUuc2l6ZSAmJiB0aGlzLkRCT3BlblJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5EQk9wZW5SZXF1ZXN0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgYWxsIGNvbGxlY3Rpb25zIHdlcmUgY3JlYXRlZFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb2xsZWN0aW9uPFQ+IChuYW1lOiBzdHJpbmcpOiBDb2xsZWN0aW9uPFQ+IHtcbiAgICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLmlkYi50cmFuc2FjdGlvbihuYW1lKS5vYmplY3RTdG9yZShuYW1lKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKHN0b3JlLCB0aGlzLmlkYik7XG4gICAgfVxuXG4gICAgY2xvc2UgKCkge1xuICAgICAgICB0aGlzLmlkYi5jbG9zZSgpO1xuICAgIH1cblxufSIsImltcG9ydCB7Q3Vyc29yLCBDdXJzb3JPcGVyYXRpb259IGZyb20gXCIuL0N1cnNvclwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbGxlY3Rpb25DcmVhdGVPcHRpb25zIHtcblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbGxlY3Rpb25JbnNlcnRPbmVPcHRpb25zIHtcblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEluc2VydE9uZVdyaXRlT3BSZXN1bHQge1xuICAgIGluc2VydGVkQ291bnQ6IG51bWJlcjtcbiAgICBpbnNlcnRlZElkOiBhbnk7XG59XG5cbmludGVyZmFjZSBJbnNlcnRXcml0ZU9wUmVzdWx0IHtcbiAgICBpbnNlcnRlZENvdW50OiBudW1iZXI7XG4gICAgaW5zZXJ0ZWRJZHM6IGFueVtdO1xufVxuXG4vL1RPRE86IGFkZCBzdXBwb3J0IGZvciBvcGVyYXRvcnMgbGlrZSAkZXFcbmV4cG9ydCB0eXBlIEZpbHRlclF1ZXJ5PFQ+ID0ge1xuICAgIFtQIGluIGtleW9mIFRdPzogVFtQXSB8IHtcbiAgICAkZXE/OiBUW1BdO1xuICAgICRndD86IFRbUF07XG4gICAgJGd0ZT86IFRbUF07XG4gICAgJGluPzogVFtQXVtdO1xuICAgICRsdD86IFRbUF07XG4gICAgJGx0ZT86IFRbUF07XG4gICAgJG5lPzogVFtQXTtcbiAgICAkbmluPzogVFtQXVtdO1xuICAgICRhbmQ/OiAoRmlsdGVyUXVlcnk8VFtQXT4gfCBUW1BdKVtdO1xuICAgICRvcj86IChGaWx0ZXJRdWVyeTxUW1BdPiB8IFRbUF0pW107XG4gICAgJG5vdD86IChGaWx0ZXJRdWVyeTxUW1BdPiB8IFRbUF0pW10gfCBUW1BdO1xuICAgICRleHByPzogYW55O1xuICAgICRqc29uU2NoZW1hPzogYW55O1xuICAgICRtb2Q/OiBbbnVtYmVyLCBudW1iZXJdO1xuICAgICRyZWdleD86IFJlZ0V4cDtcbiAgICAkb3B0aW9ucz86IHN0cmluZztcbiAgICAkdGV4dD86IHtcbiAgICAgICAgJHNlYXJjaDogc3RyaW5nO1xuICAgICAgICAkbGFuZ3VhZ2U/OiBzdHJpbmc7XG4gICAgICAgICRjYXNlU2Vuc2l0aXZlPzogYm9vbGVhbjtcbiAgICAgICAgJGRpYWNyYXRpY1NlbnNpdGl2ZT86IGJvb2xlYW47XG4gICAgfTtcbiAgICAkd2hlcmU6IE9iamVjdDtcbiAgICAkZ2VvSW50ZXJzZWN0cz86IE9iamVjdDtcbiAgICAkZ2VvV2l0aGluPzogT2JqZWN0O1xuICAgICRuZWFyPzogT2JqZWN0O1xuICAgICRuZWFyU3BoZXJlPzogT2JqZWN0O1xuICAgICRlbGVtTWF0Y2g/OiBPYmplY3Q7XG4gICAgJHNpemU/OiBudW1iZXI7XG4gICAgJGJpdHNBbGxDbGVhcj86IE9iamVjdDtcbiAgICAkYml0c0FsbFNldD86IE9iamVjdDtcbiAgICAkYml0c0FueUNsZWFyPzogT2JqZWN0O1xuICAgICRiaXRzQW55U2V0PzogT2JqZWN0O1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn07XG59IHwgeyBba2V5OiBzdHJpbmddOiBhbnkgfTtcblxuaW50ZXJmYWNlIENvbW1vbk9wdGlvbnMge1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERlbGV0ZVdyaXRlT3BSZXN1bHRPYmplY3Qge1xuICAgIC8vVGhlIHJhdyByZXN1bHQgcmV0dXJuZWQgZnJvbSBNb25nb0RCLCBmaWVsZCB3aWxsIHZhcnkgZGVwZW5kaW5nIG9uIHNlcnZlciB2ZXJzaW9uLlxuICAgIHJlc3VsdDoge1xuICAgICAgICAvL0lzIDEgaWYgdGhlIGNvbW1hbmQgZXhlY3V0ZWQgY29ycmVjdGx5LlxuICAgICAgICBvaz86IG51bWJlcjtcbiAgICAgICAgLy9UaGUgdG90YWwgY291bnQgb2YgZG9jdW1lbnRzIGRlbGV0ZWQuXG4gICAgICAgIG4/OiBudW1iZXI7XG4gICAgfVxuICAgIC8vVGhlIG51bWJlciBvZiBkb2N1bWVudHMgZGVsZXRlZC5cbiAgICBkZWxldGVkQ291bnQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBDb2xsZWN0aW9uPFQ+IHtcbiAgICBjb25zdHJ1Y3RvciAocHJpdmF0ZSBzdG9yZTogSURCT2JqZWN0U3RvcmUsIHByaXZhdGUgaWRiOiBJREJEYXRhYmFzZSkge1xuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jc1xuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICovXG4gICAgaW5zZXJ0T25lIChkb2NzOiBPYmplY3QsIG9wdGlvbnM/OiBDb2xsZWN0aW9uSW5zZXJ0T25lT3B0aW9ucyk6IFByb21pc2U8SW5zZXJ0T25lV3JpdGVPcFJlc3VsdD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5pbnNlcnRNYW55KFtkb2NzXSwgb3B0aW9ucykudGhlbihyZXMgPT4gKHtpbnNlcnRlZENvdW50IDogMSwgaW5zZXJ0ZWRJZCA6IHJlcy5pbnNlcnRlZElkc1swXX0pKTtcbiAgICB9XG5cbiAgICBpbnNlcnRNYW55IChkb2NzOiBPYmplY3RbXSwgb3B0aW9ucz86IENvbGxlY3Rpb25JbnNlcnRPbmVPcHRpb25zKTogUHJvbWlzZTxJbnNlcnRXcml0ZU9wUmVzdWx0PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxJbnNlcnRXcml0ZU9wUmVzdWx0PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBsZXQgaW5zZXJ0ZWRJZHM6IGFueVtdID0gW107XG4gICAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSB0aGlzLmlkYi50cmFuc2FjdGlvbih0aGlzLnN0b3JlLm5hbWUsIFwicmVhZHdyaXRlXCIpO1xuXG4gICAgICAgICAgICAvLyBUbyBkZXRlcm1pbmUgaWYgdGhlIGFkZCBvcGVyYXRpb24gaGFzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHksXG4gICAgICAgICAgICAvLyBsaXN0ZW4gZm9yIHRoZSB0cmFuc2FjdGlvbuKAmXMgY29tcGxldGUgZXZlbnQgaW4gYWRkaXRpb24gdG8gdGhlXG4gICAgICAgICAgICAvLyBJREJPYmplY3RTdG9yZS5hZGQgcmVxdWVzdOKAmXMgc3VjY2VzcyBldmVudCxcbiAgICAgICAgICAgIC8vIGJlY2F1c2UgdGhlIHRyYW5zYWN0aW9uIG1heSBzdGlsbCBmYWlsIGFmdGVyIHRoZSBzdWNjZXNzIGV2ZW50IGZpcmVzLlxuICAgICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChpbnNlcnRlZElkcy5sZW5ndGggPT09IGRvY3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe2luc2VydGVkQ291bnQgOiBpbnNlcnRlZElkcy5sZW5ndGgsIGluc2VydGVkSWRzfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gc3VjY2Vzc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24ub25lcnJvciA9IHJlamVjdDtcblxuICAgICAgICAgICAgY29uc3Qgb2JqZWN0U3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZSh0aGlzLnN0b3JlLm5hbWUpO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvYyBvZiBkb2NzKSB7XG4gICAgICAgICAgICAgICAgLy8gTWFrZSBhIHJlcXVlc3QgdG8gYWRkIGRvY3Mgb2JqZWN0IHRvIHRoZSBvYmplY3Qgc3RvcmVcbiAgICAgICAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZVJlcXVlc3QgPSBvYmplY3RTdG9yZS5hZGQoZG9jKTtcblxuICAgICAgICAgICAgICAgIG9iamVjdFN0b3JlUmVxdWVzdC5vbmVycm9yID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgIG9iamVjdFN0b3JlUmVxdWVzdC5vbnN1Y2Nlc3MgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHJlc3VsdCBvZiBhIHJlcXVlc3QgZ2VuZXJhdGVkIGZyb20gYSBjYWxsIHRvIGFkZCgpXG4gICAgICAgICAgICAgICAgICAgIC8vIGlzIHRoZSBrZXkgb2YgdGhlIHZhbHVlIHRoYXQgd2FzIGFkZGVkLlxuICAgICAgICAgICAgICAgICAgICBpbnNlcnRlZElkcy5wdXNoKG9iamVjdFN0b3JlUmVxdWVzdC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Q3Vyc29yIChxdWVyeTogRmlsdGVyUXVlcnk8VD4sIG9wZXJhdGlvbjogQ3Vyc29yT3BlcmF0aW9uID0gQ3Vyc29yT3BlcmF0aW9uLlJFQUQpOiBDdXJzb3I8VD4ge1xuICAgICAgICBjb25zdCBtb2RlID0gb3BlcmF0aW9uID09IEN1cnNvck9wZXJhdGlvbi5SRUFEID8gXCJyZWFkb25seVwiIDogXCJyZWFkd3JpdGVcIjtcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB0aGlzLmlkYi50cmFuc2FjdGlvbih0aGlzLnN0b3JlLm5hbWUsIG1vZGUpO1xuICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHRoaXMuc3RvcmUubmFtZSk7XG4gICAgICAgIC8vVE9ETzogcHJvY2VzcyB0aGUgcXVlcnlcbiAgICAgICAgLy8gVGhlIGdldEFsbCgpIG1ldGhvZCBvZiB0aGUgSURCT2JqZWN0U3RvcmUgaW50ZXJmYWNlIHJldHVybnMgYW4gSURCUmVxdWVzdCBvYmplY3RcbiAgICAgICAgLy8gY29udGFpbmluZyBhbGwgb2JqZWN0cyBpbiB0aGUgb2JqZWN0IHN0b3JlIG1hdGNoaW5nIHRoZSBzcGVjaWZpZWQgcGFyYW1ldGVyIG9yXG4gICAgICAgIC8vIGFsbCBvYmplY3RzIGluIHRoZSBzdG9yZSBpZiBubyBwYXJhbWV0ZXJzIGFyZSBnaXZlbi5cbiAgICAgICAgbGV0IHJlcXVlc3Q6IGFueTtcbiAgICAgICAgaWYgKCFxdWVyeSkge1xuICAgICAgICAgICAgcmVxdWVzdCA9IG9iamVjdFN0b3JlLmdldEFsbCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVxdWVzdCA9IG9iamVjdFN0b3JlLm9wZW5DdXJzb3IoKSBhcyBJREJSZXF1ZXN0PElEQkN1cnNvcldpdGhWYWx1ZSB8IG51bGw+O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHJlcXVlc3QsIHF1ZXJ5LCBvcGVyYXRpb24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHF1ZXJ5W29wdGlvbmFsXVxuICAgICAqIFRoZSBmaW5kKCkgbWV0aG9kIHdpdGggbm8gcGFyYW1ldGVycyByZXR1cm5zIGFsbCBkb2N1bWVudHMgZnJvbSBhIGNvbGxlY3Rpb24gYW5kIHJldHVybnMgYWxsIGZpZWxkcyBmb3IgdGhlIGRvY3VtZW50cy5cbiAgICAgKi9cbiAgICBmaW5kIChxdWVyeT86IEZpbHRlclF1ZXJ5PFQ+KTogQ3Vyc29yPFQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q3Vyc29yKHF1ZXJ5KTtcbiAgICB9XG5cblxuICAgIGRlbGV0ZU1hbnkgKGZpbHRlcjogRmlsdGVyUXVlcnk8VD4sIG9wdGlvbnM/OiBDb21tb25PcHRpb25zKTogUHJvbWlzZTxEZWxldGVXcml0ZU9wUmVzdWx0T2JqZWN0PiB7XG4gICAgICAgIGxldCBjdXJzb3IgPSB0aGlzLmdldEN1cnNvcihmaWx0ZXIsIEN1cnNvck9wZXJhdGlvbi5ERUxFVEUpO1xuXG4gICAgICAgIHJldHVybiBjdXJzb3IuZ2V0UmVzdWx0KCkudGhlbihkZWxldGVkID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzdWx0IDoge1xuICAgICAgICAgICAgICAgICAgICAvL0lzIDEgaWYgdGhlIGNvbW1hbmQgZXhlY3V0ZWQgY29ycmVjdGx5LlxuICAgICAgICAgICAgICAgICAgICBvayA6IDEsXG4gICAgICAgICAgICAgICAgICAgIC8vVGhlIHRvdGFsIGNvdW50IG9mIGRvY3VtZW50cyBkZWxldGVkLlxuICAgICAgICAgICAgICAgICAgICBuIDogZGVsZXRlZC5sZW5ndGhcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vVGhlIG51bWJlciBvZiBkb2N1bWVudHMgZGVsZXRlZC5cbiAgICAgICAgICAgICAgICBkZWxldGVkQ291bnQgOiBkZWxldGVkLmxlbmd0aFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbn0iLCJpbXBvcnQge0ZpbHRlclF1ZXJ5fSBmcm9tIFwiLi9Db2xsZWN0aW9uXCI7XG5cbmV4cG9ydCBlbnVtIEN1cnNvck9wZXJhdGlvbiB7XG4gICAgREVMRVRFLCBVUERBVEUsIFJFQURcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQ3Vyc29yPFQ+IHtcbiAgICB0b0FycmF5ICgpOiBQcm9taXNlPFRbXT5cbn1cblxuLy9bUCBpbiBrZXlvZiBUXT86IFRbUF1cbmV4cG9ydCBjbGFzcyBDdXJzb3I8VCBleHRlbmRzIHsgW2tleTogc3RyaW5nXTogYW55IH0+IGltcGxlbWVudHMgSUN1cnNvcjxUPiB7XG4gICAgcHJpdmF0ZSByZXN1bHQ6IFByb21pc2U8VFtdPjtcbiAgICBwcml2YXRlIF9yZXN1bHQ6IFRbXTtcblxuICAgIGNvbnN0cnVjdG9yIChwcml2YXRlIHJlcXVlc3Q6IElEQlJlcXVlc3QsIGZpbHRlcj86IEZpbHRlclF1ZXJ5PFQ+LCBvcGVyYXRpb246IEN1cnNvck9wZXJhdGlvbiA9IEN1cnNvck9wZXJhdGlvbi5SRUFEKSB7XG4gICAgICAgIHRoaXMucmVzdWx0ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3Qub25lcnJvciA9IGUgPT4ge1xuICAgICAgICAgICAgICAgIHJlamVjdCh0aGlzLnJlcXVlc3QuZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdC5vbnN1Y2Nlc3MgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBEbyBzb21ldGhpbmcgd2l0aCB0aGUgcmVxdWVzdC5yZXN1bHQhXG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gcmVxdWVzdC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnNvciAmJiBjdXJzb3IgaW5zdGFuY2VvZiBJREJDdXJzb3JXaXRoVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzdWx0ID0gdGhpcy5fcmVzdWx0IHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICAvLyBjdXJzb3IudmFsdWUgY29udGFpbnMgdGhlIGN1cnJlbnQgcmVjb3JkIGJlaW5nIGl0ZXJhdGVkIHRocm91Z2hcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBpcyB3aGVyZSB5b3UnZCBkbyBzb21ldGhpbmcgd2l0aCB0aGUgcmVzdWx0XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUN1cnNvck9wZXJhdGlvbihvcGVyYXRpb24sIGN1cnNvciwgZmlsdGVyKTtcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXN1bHQgPSB0aGlzLl9yZXN1bHQgfHwgdGhpcy5yZXF1ZXN0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLl9yZXN1bHQpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9KTtcblxuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhcHBseUZpbHRlciAodmFsdWU6IFQsIGZpbHRlcjogRmlsdGVyUXVlcnk8VD4pIHtcbiAgICAgICAgbGV0IGZpbHRlcktleXMgPSBPYmplY3Qua2V5cyhmaWx0ZXIpO1xuXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGZpbHRlcktleXMpIHtcbiAgICAgICAgICAgIGlmIChrZXkuc3RhcnRzV2l0aCgnJCcpKSB7XG4gICAgICAgICAgICAgICAgLy9UT0RPOiBvcGVyYXRvcnNcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWVba2V5XSAhPSBmaWx0ZXJba2V5XSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGV4ZWN1dGVDdXJzb3JPcGVyYXRpb24gKG9wZXJhdGlvbjogQ3Vyc29yT3BlcmF0aW9uLCBjdXJzb3I6IElEQkN1cnNvcldpdGhWYWx1ZSwgZmlsdGVyPzogRmlsdGVyUXVlcnk8VD4pIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBmaWx0ZXIgPyB0aGlzLmFwcGx5RmlsdGVyKGN1cnNvci52YWx1ZSwgZmlsdGVyKSA6IGN1cnNvci52YWx1ZTtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHtcbiAgICAgICAgICAgIGNhc2UgQ3Vyc29yT3BlcmF0aW9uLkRFTEVURTpcbiAgICAgICAgICAgICAgICBjdXJzb3IuZGVsZXRlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEN1cnNvck9wZXJhdGlvbi5VUERBVEU6XG4gICAgICAgICAgICAgICAgLy9UT0RPOiBVcGRhdGVcbiAgICAgICAgICAgICAgICAvLyA/Pz8gY3Vyc29yLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0UmVzdWx0ICgpOiBQcm9taXNlPFRbXT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQ7XG4gICAgfVxuXG5cbi8vIHNvcnRWYWx1ZTogc3RyaW5nO1xuICAgIC8vIHRpbWVvdXQ6IGJvb2xlYW47XG4gICAgLy8gcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlO1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI2FkZEN1cnNvckZsYWcgKi9cbiAgICAvLyBhZGRDdXJzb3JGbGFnKGZsYWc6IHN0cmluZywgdmFsdWU6IGJvb2xlYW4pOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjYWRkUXVlcnlNb2RpZmllciAqL1xuICAgIC8vIGFkZFF1ZXJ5TW9kaWZpZXIobmFtZTogc3RyaW5nLCB2YWx1ZTogYm9vbGVhbik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNiYXRjaFNpemUgKi9cbiAgICAvLyBiYXRjaFNpemUodmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNjbG9uZSAqL1xuICAgIC8vIGNsb25lKCk6IEN1cnNvcjxUPjsgLy8gc3RpbGwgcmV0dXJucyB0aGUgc2FtZSB0eXBlXG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjY2xvc2UgKi9cbiAgICAvLyBjbG9zZSgpOiBQcm9taXNlPEN1cnNvclJlc3VsdD47XG4gICAgLy8gY2xvc2UoY2FsbGJhY2s6IE1vbmdvQ2FsbGJhY2s8Q3Vyc29yUmVzdWx0Pik6IHZvaWQ7XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjY29sbGF0aW9uICovXG4gICAgLy8gY29sbGF0aW9uKHZhbHVlOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjY29tbWVudCAqL1xuICAgIC8vIGNvbW1lbnQodmFsdWU6IHN0cmluZyk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNjb3VudCAqL1xuICAgIC8vIGNvdW50KGNhbGxiYWNrOiBNb25nb0NhbGxiYWNrPG51bWJlcj4pOiB2b2lkO1xuICAgIC8vIGNvdW50KGFwcGx5U2tpcExpbWl0OiBib29sZWFuLCBjYWxsYmFjazogTW9uZ29DYWxsYmFjazxudW1iZXI+KTogdm9pZDtcbiAgICAvLyBjb3VudChvcHRpb25zOiBDdXJzb3JDb21tZW50T3B0aW9ucywgY2FsbGJhY2s6IE1vbmdvQ2FsbGJhY2s8bnVtYmVyPik6IHZvaWQ7XG4gICAgLy8gY291bnQoYXBwbHlTa2lwTGltaXQ6IGJvb2xlYW4sIG9wdGlvbnM6IEN1cnNvckNvbW1lbnRPcHRpb25zLCBjYWxsYmFjazogTW9uZ29DYWxsYmFjazxudW1iZXI+KTogdm9pZDtcbiAgICAvLyBjb3VudChhcHBseVNraXBMaW1pdD86IGJvb2xlYW4sIG9wdGlvbnM/OiBDdXJzb3JDb21tZW50T3B0aW9ucyk6IFByb21pc2U8bnVtYmVyPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNleHBsYWluICovXG4gICAgLy8gZXhwbGFpbigpOiBQcm9taXNlPEN1cnNvclJlc3VsdD47XG4gICAgLy8gZXhwbGFpbihjYWxsYmFjazogTW9uZ29DYWxsYmFjazxDdXJzb3JSZXN1bHQ+KTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNmaWx0ZXIgKi9cbiAgICAvLyBmaWx0ZXIoZmlsdGVyOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjZm9yRWFjaCAqL1xuICAgIC8vIGZvckVhY2goaXRlcmF0b3I6IEl0ZXJhdG9yQ2FsbGJhY2s8VD4sIGNhbGxiYWNrOiBFbmRDYWxsYmFjayk6IHZvaWQ7XG4gICAgLy8gZm9yRWFjaChpdGVyYXRvcjogSXRlcmF0b3JDYWxsYmFjazxUPik6IFByb21pc2U8dm9pZD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjaGFzTmV4dCAqL1xuICAgIC8vIGhhc05leHQoKTogUHJvbWlzZTxib29sZWFuPjtcbiAgICAvLyBoYXNOZXh0KGNhbGxiYWNrOiBNb25nb0NhbGxiYWNrPGJvb2xlYW4+KTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNoaW50ICovXG4gICAgLy8gaGludChoaW50OiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjaXNDbG9zZWQgKi9cbiAgICAvLyBpc0Nsb3NlZCgpOiBib29sZWFuO1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI2xpbWl0ICovXG4gICAgLy8gbGltaXQodmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNtYXAgKi9cbiAgICAvLyBtYXA8VT4odHJhbnNmb3JtOiAoZG9jdW1lbnQ6IFQpID0+IFUpOiBDdXJzb3I8VT47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbWF4ICovXG4gICAgLy8gbWF4KG1heDogbnVtYmVyKTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI21heEF3YWl0VGltZU1TICovXG4gICAgLy8gbWF4QXdhaXRUaW1lTVModmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNtYXhTY2FuICovXG4gICAgLy8gbWF4U2NhbihtYXhTY2FuOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbWF4VGltZU1TICovXG4gICAgLy8gbWF4VGltZU1TKHZhbHVlOiBudW1iZXIpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbWluICovXG4gICAgLy8gbWluKG1pbjogbnVtYmVyKTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI25leHQgKi9cbiAgICAvLyBuZXh0KCk6IFByb21pc2U8VCB8IG51bGw+O1xuICAgIC8vIG5leHQoY2FsbGJhY2s6IE1vbmdvQ2FsbGJhY2s8VCB8IG51bGw+KTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNwcm9qZWN0ICovXG4gICAgLy8gcHJvamVjdCh2YWx1ZTogT2JqZWN0KTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI3JlYWQgKi9cbiAgICAvLyByZWFkKHNpemU6IG51bWJlcik6IHN0cmluZyB8IEJ1ZmZlciB8IHZvaWQ7XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbmV4dCAqL1xuICAgIC8vIHJldHVybktleShyZXR1cm5LZXk6IE9iamVjdCk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNyZXdpbmQgKi9cbiAgICAvLyByZXdpbmQoKTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzZXRDdXJzb3JPcHRpb24gKi9cbiAgICAvLyBzZXRDdXJzb3JPcHRpb24oZmllbGQ6IHN0cmluZywgdmFsdWU6IE9iamVjdCk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzZXRSZWFkUHJlZmVyZW5jZSAqL1xuICAgIC8vIHNldFJlYWRQcmVmZXJlbmNlKHJlYWRQcmVmZXJlbmNlOiBzdHJpbmcgfCBSZWFkUHJlZmVyZW5jZSk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzaG93UmVjb3JkSWQgKi9cbiAgICAvLyBzaG93UmVjb3JkSWQoc2hvd1JlY29yZElkOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjc2tpcCAqL1xuICAgIC8vIHNraXAodmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzbmFwc2hvdCAqL1xuICAgIC8vIHNuYXBzaG90KHNuYXBzaG90OiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjc29ydCAqL1xuICAgIC8vIHNvcnQoa2V5T3JMaXN0OiBzdHJpbmcgfCBPYmplY3RbXSB8IE9iamVjdCwgZGlyZWN0aW9uPzogbnVtYmVyKTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI3N0cmVhbSAqL1xuICAgIC8vIHN0cmVhbShvcHRpb25zPzogeyB0cmFuc2Zvcm0/OiBGdW5jdGlvbiB9KTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI3RvQXJyYXkgKi9cbiAgICB0b0FycmF5ICgpOiBQcm9taXNlPFRbXT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQudGhlbihyZXN1bHQgPT4gQXJyYXkuZnJvbShyZXN1bHQpIGFzIFRbXSk7XG4gICAgfVxuXG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjdW5zaGlmdCAqL1xuICAgIC8vIHVuc2hpZnQoc3RyZWFtOiBCdWZmZXIgfCBzdHJpbmcpOiB2b2lkO1xuXG59Il0sInNvdXJjZVJvb3QiOiIifQ==