!function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1).IndexedClient.connect("example").then(function(e){1==e.version?Promise.all([e.createCollection("a_simple_collection").then(function(e){e.insertOne({a:1}).then(function(e){console.log("a_simple_collection",e)})}),e.createCollection("another_collection").then(function(e){e.insertMany([{b:2},{c:3},{d:4}]).then(function(e){console.log("another_collection",e)})})]).then(t=>{e.collection("another_collection").then(e=>{e.find().toArray().then(e=>{console.log(e)})})}):e.collection("another_collection").then(e=>{e.find().toArray().then(e=>{console.log(e)})})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2);t.IndexedClient=class{static connect(e,t){return o.Db.open(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(3);class s{constructor(e){this.idb=e,this.collectionQueue=new Set}static open(e,t){const n=self.indexedDB.open(e);return new Promise((e,t)=>{n.addEventListener("error",t),n.addEventListener("success",function(t){let o=new s(n.result);e(o)}),n.onblocked=(e=>{console.log("blocked")})})}set openRequest(e){this.DBOpenRequest=e}get version(){return this.idb?this.idb.version:0}createCollection(e,t={autoIncrement:!0}){if(this.idb.objectStoreNames.contains(e))throw new Error("Collection already exists");if(!this.collectionQueue.size&&!this.DBOpenRequest){let e=this.version+1;this.idb.close(),this.DBOpenRequest=self.indexedDB.open(this.idb.name,e)}return this.collectionQueue.add(e),console.log(`createCollection: ${e}, collectionQueue:${this.collectionQueue.size}`),new Promise((n,s)=>{this.DBOpenRequest.addEventListener("error",s),this.DBOpenRequest.addEventListener("upgradeneeded",s=>{let r=this.DBOpenRequest.result;this.idb=r;const i=r.createObjectStore(e,t);i.transaction.addEventListener("complete",t=>{let s=new o.Collection(i,this.idb);this.collectionQueue.delete(e),n(s)})}),this.DBOpenRequest.onsuccess=(t=>{if(console.log(`DBOpenRequest 'success' collection: ${e}, collectionQueue:${this.collectionQueue.size}`),this.collectionQueue.size||!this.DBOpenRequest)throw new Error("Not all collections were created");this.DBOpenRequest=null})})}collection(e){if(this.idb.objectStoreNames.contains(e)){const t=this.idb.transaction(e).objectStore(e);return Promise.resolve(new o.Collection(t,this.idb))}return Promise.reject("No such collection")}}t.Db=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(4);t.Collection=class{constructor(e,t){this.store=e,this.idb=t}insertOne(e,t){return this.insertMany([e],t).then(e=>({insertedCount:1,insertedId:e.insertedIds[0]}))}insertMany(e,t){return new Promise((t,n)=>{let o=[],s=this.idb.transaction(this.store.name,"readwrite");s.oncomplete=(s=>{o.length===e.length?t({insertedCount:o.length,insertedIds:o}):n("No success")}),s.onerror=n;const r=s.objectStore(this.store.name);for(const t of e){const e=r.add(t);e.onerror=n,e.onsuccess=(t=>{o.push(e.result)})}})}find(e){const t=this.idb.transaction(this.store.name).objectStore(this.store.name).getAll();return new o.Cursor(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Cursor=class{constructor(e){this.request=e}toArray(){return new Promise((e,t)=>{this.request.onerror=t,this.request.onsuccess=(t=>{e(this.request.result)})})}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGUvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0luZGV4ZWRDbGllbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0RiLnRzIiwid2VicGFjazovLy8uL3NyYy9Db2xsZWN0aW9uLnRzIiwid2VicGFjazovLy8uL3NyYy9DdXJzb3IudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJJbmRleGVkQ2xpZW50IiwiY29ubmVjdCIsInRoZW4iLCJkYiIsInZlcnNpb24iLCJQcm9taXNlIiwiYWxsIiwiY3JlYXRlQ29sbGVjdGlvbiIsImNvbGxlY3Rpb24iLCJpbnNlcnRPbmUiLCJhIiwiY29uc29sZSIsImxvZyIsImluc2VydE1hbnkiLCJiIiwicmVzIiwiZmluZCIsInRvQXJyYXkiLCJ2YWx1ZXMiLCJEYl8xIiwiW29iamVjdCBPYmplY3RdIiwib3B0aW9ucyIsIkRiIiwib3BlbiIsIkNvbGxlY3Rpb25fMSIsImlkYiIsInRoaXMiLCJjb2xsZWN0aW9uUXVldWUiLCJTZXQiLCJjb2xsZWN0aW9ucyIsIkRCT3BlblJlcXVlc3QiLCJzZWxmIiwiaW5kZXhlZERCIiwicmVzb2x2ZSIsInJlamVjdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInJlc3VsdCIsIm9uYmxvY2tlZCIsImUiLCJvcGVuUmVxdWVzdCIsInJlcSIsImF1dG9JbmNyZW1lbnQiLCJvYmplY3RTdG9yZU5hbWVzIiwiY29udGFpbnMiLCJFcnJvciIsInNpemUiLCJ2IiwiY2xvc2UiLCJhZGQiLCJzdG9yZSIsImNyZWF0ZU9iamVjdFN0b3JlIiwidHJhbnNhY3Rpb24iLCJDb2xsZWN0aW9uIiwiZGVsZXRlIiwib25zdWNjZXNzIiwib2JqZWN0U3RvcmUiLCJDdXJzb3JfMSIsImRvY3MiLCJpbnNlcnRlZENvdW50IiwiaW5zZXJ0ZWRJZCIsImluc2VydGVkSWRzIiwib25jb21wbGV0ZSIsImxlbmd0aCIsIm9uZXJyb3IiLCJkb2MiLCJvYmplY3RTdG9yZVJlcXVlc3QiLCJwdXNoIiwicXVlcnkiLCJyZXF1ZXN0IiwiZ2V0QWxsIiwiQ3Vyc29yIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLGFBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFE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aGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJpbXBvcnQge0luZGV4ZWRDbGllbnR9IGZyb20gXCIuLi9JbmRleGVkQ2xpZW50XCI7XG5cbkluZGV4ZWRDbGllbnQuY29ubmVjdChcImV4YW1wbGVcIikudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICBpZiAoZGIudmVyc2lvbiA9PSAxKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhIGNvbGxlY3Rpb25cbiAgICAgICAgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgZGIuY3JlYXRlQ29sbGVjdGlvbihcImFfc2ltcGxlX2NvbGxlY3Rpb25cIikudGhlbihmdW5jdGlvbiAoY29sbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhIGRvY3VtZW50IGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5pbnNlcnRPbmUoe2EgOiAxfSkudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgICAgICAvLyBGaW5pc2ggdXAgdGVzdFxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFfc2ltcGxlX2NvbGxlY3Rpb25cIiwgcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGRiLmNyZWF0ZUNvbGxlY3Rpb24oXCJhbm90aGVyX2NvbGxlY3Rpb25cIikudGhlbihmdW5jdGlvbiAoY29sbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhIGRvY3VtZW50IGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5pbnNlcnRNYW55KFt7YiA6IDJ9LCB7YyA6IDN9LCB7ZCA6IDR9XSkudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgICAgICAvLyBGaW5pc2ggdXAgdGVzdFxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFub3RoZXJfY29sbGVjdGlvblwiLCByKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXSkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgZGIuY29sbGVjdGlvbihcImFub3RoZXJfY29sbGVjdGlvblwiKS50aGVuKGMgPT4ge1xuICAgICAgICAgICAgICAgIGMuZmluZCgpLnRvQXJyYXkoKS50aGVuKHZhbHVlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGRiLmNvbGxlY3Rpb24oXCJhbm90aGVyX2NvbGxlY3Rpb25cIikudGhlbihjID0+IHtcbiAgICAgICAgICAgIGMuZmluZCgpLnRvQXJyYXkoKS50aGVuKHZhbHVlcyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codmFsdWVzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG5cbn0pOyIsImltcG9ydCB7RGJ9IGZyb20gXCIuL0RiXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5kZXhlZENsaWVudE9wdGlvbnMge1xuICAgIGNvbGxlY3Rpb25zPzogc3RyaW5nW11cbn1cblxuZXhwb3J0IGNsYXNzIEluZGV4ZWRDbGllbnQge1xuXG4gICAgc3RhdGljIGNvbm5lY3QgKG5hbWU6IHN0cmluZywgb3B0aW9ucz86IEluZGV4ZWRDbGllbnRPcHRpb25zKTogUHJvbWlzZTxEYj4ge1xuICAgICAgICAvLyBJZiB0aGUgdmVyc2lvbiBpcyBub3QgcHJvdmlkZWQgYW5kIHRoZSBkYXRhYmFzZSBleGlzdHMsIHRoZW4gYSBjb25uZWN0aW9uIHRvIHRoZSBkYXRhYmFzZSB3aWxsIGJlIG9wZW5lZCB3aXRob3V0IGNoYW5naW5nIGl0cyB2ZXJzaW9uLiBJZiB0aGUgdmVyc2lvbiBpcyBub3QgcHJvdmlkZWQgYW5kIHRoZSBkYXRhYmFzZSBkb2VzIG5vdCBleGlzdCwgdGhlbiBpdCB3aWxsIGJlIGNyZWF0ZWQgd2l0aCB2ZXJzaW9uIDEuXG4gICAgICAgIHJldHVybiBEYi5vcGVuKG5hbWUpO1xuICAgIH1cblxufSIsImltcG9ydCB7Q29sbGVjdGlvbn0gZnJvbSBcIi4vQ29sbGVjdGlvblwiO1xuXG5leHBvcnQgY2xhc3MgRGIge1xuICAgIHByaXZhdGUgY29sbGVjdGlvblF1ZXVlOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIHByaXZhdGUgREJPcGVuUmVxdWVzdDogSURCT3BlbkRCUmVxdWVzdDtcblxuICAgIHN0YXRpYyBvcGVuIChuYW1lOiBzdHJpbmcsIGNvbGxlY3Rpb25zPzogc3RyaW5nW10pOiBQcm9taXNlPERiPiB7XG5cbiAgICAgICAgY29uc3QgREJPcGVuUmVxdWVzdCA9IHNlbGYuaW5kZXhlZERCLm9wZW4obmFtZSk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPERiPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgICAgICAgIC8vIHRoZXNlIHR3byBldmVudCBoYW5kbGVycyBhY3Qgb24gdGhlIGRhdGFiYXNlIGJlaW5nIG9wZW5lZFxuICAgICAgICAgICAgLy8gc3VjY2Vzc2Z1bGx5LCBvciBub3RcbiAgICAgICAgICAgIERCT3BlblJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCByZWplY3QpO1xuICAgICAgICAgICAgREJPcGVuUmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gc3RvcmUgdGhlIHJlc3VsdCBvZiBvcGVuaW5nIHRoZSBkYXRhYmFzZSBpbiB0aGUgZGJcbiAgICAgICAgICAgICAgICAvLyB2YXJpYWJsZS4gVGhpcyBpcyB1c2VkIGEgbG90IGxhdGVyIG9uLCBmb3Igb3BlbmluZ1xuICAgICAgICAgICAgICAgIC8vIHRyYW5zYWN0aW9ucyBhbmQgc3VjaGxpa2UuXG4gICAgICAgICAgICAgICAgbGV0IGRiID0gbmV3IERiKERCT3BlblJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgREJPcGVuUmVxdWVzdC5vbmJsb2NrZWQgPSAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdibG9ja2VkJylcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZXQgb3BlblJlcXVlc3QgKHJlcTogSURCT3BlbkRCUmVxdWVzdCkge1xuICAgICAgICB0aGlzLkRCT3BlblJlcXVlc3QgPSByZXE7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IgKHByaXZhdGUgaWRiOiBJREJEYXRhYmFzZSkge1xuICAgIH1cblxuICAgIGdldCB2ZXJzaW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWRiID8gdGhpcy5pZGIudmVyc2lvbiA6IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gIE9wdGlvbmFsXG4gICAgICogQW4gb3B0aW9ucyBvYmplY3Qgd2hvc2UgYXR0cmlidXRlcyBhcmUgb3B0aW9uYWwgcGFyYW1ldGVycyB0byB0aGUgbWV0aG9kLiBJdCBpbmNsdWRlcyB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAgICogfCBBdHRyaWJ1dGUgICAgICAgICAgfCBEZXNjcmlwdGlvbiAgICAgICB8XG4gICAgICogfCAtLS0tLS0tLS0tLS0tLS0tIHwgLS0tLS0tLS0tLS0tLS0tICAgfFxuICAgICAqIHwga2V5UGF0aCAgICAgICAgICB8IFRoZSBrZXkgcGF0aCB0byBiZSB1c2VkIGJ5IHRoZSBuZXcgb2JqZWN0IHN0b3JlLiBJZiBlbXB0eSBvciBub3Qgc3BlY2lmaWVkLCB0aGUgb2JqZWN0IHN0b3JlIGlzIGNyZWF0ZWQgd2l0aG91dCBhIGtleSBwYXRoIGFuZCB1c2VzIG91dC1vZi1saW5lIGtleXMuIFlvdSBjYW4gYWxzbyBwYXNzIGluIGFuIGFycmF5IGFzIGEga2V5UGF0aC4gfFxuICAgICAqIHwgYXV0b0luY3JlbWVudCAgICB8IElmIHRydWUsIHRoZSBvYmplY3Qgc3RvcmUgaGFzIGEga2V5IGdlbmVyYXRvci4gRGVmYXVsdHMgdG8gZmFsc2UuIHxcbiAgICAgKiBVbmtub3duIHBhcmFtZXRlcnMgYXJlIGlnbm9yZWQuXG4gICAgICovXG4gICAgY3JlYXRlQ29sbGVjdGlvbiAobmFtZTogc3RyaW5nLCBvcHRpb25zOiBJREJPYmplY3RTdG9yZVBhcmFtZXRlcnMgPSB7YXV0b0luY3JlbWVudCA6IHRydWV9KTogUHJvbWlzZTxDb2xsZWN0aW9uPiB7XG4gICAgICAgIGlmICh0aGlzLmlkYi5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKG5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2xsZWN0aW9uIGFscmVhZHkgZXhpc3RzXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5jb2xsZWN0aW9uUXVldWUuc2l6ZSAmJiAhdGhpcy5EQk9wZW5SZXF1ZXN0KSB7XG4gICAgICAgICAgICBsZXQgdiA9IHRoaXMudmVyc2lvbiArIDE7XG4gICAgICAgICAgICB0aGlzLmlkYi5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5EQk9wZW5SZXF1ZXN0ID0gc2VsZi5pbmRleGVkREIub3Blbih0aGlzLmlkYi5uYW1lLCB2KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25RdWV1ZS5hZGQobmFtZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBjcmVhdGVDb2xsZWN0aW9uOiAke25hbWV9LCBjb2xsZWN0aW9uUXVldWU6JHt0aGlzLmNvbGxlY3Rpb25RdWV1ZS5zaXplfWApO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8Q29sbGVjdGlvbj4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgLy8gdGhlc2UgdHdvIGV2ZW50IGhhbmRsZXJzIGFjdCBvbiB0aGUgZGF0YWJhc2UgYmVpbmcgb3BlbmVkXG4gICAgICAgICAgICAvLyBzdWNjZXNzZnVsbHksIG9yIG5vdFxuICAgICAgICAgICAgdGhpcy5EQk9wZW5SZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgcmVqZWN0KTtcblxuICAgICAgICAgICAgdGhpcy5EQk9wZW5SZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3VwZ3JhZGVuZWVkZWQnLCBlID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgZGI6IElEQkRhdGFiYXNlID0gdGhpcy5EQk9wZW5SZXF1ZXN0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICB0aGlzLmlkYiA9IGRiO1xuICAgICAgICAgICAgICAgIC8vVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCBvbmx5IHdpdGhpbiBhIHZlcnNpb25jaGFuZ2UgdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZShuYW1lLCBvcHRpb25zKTtcblxuICAgICAgICAgICAgICAgIC8vIFVzZSB0cmFuc2FjdGlvbiBvbmNvbXBsZXRlIHRvIG1ha2Ugc3VyZSB0aGUgb2JqZWN0U3RvcmUgY3JlYXRpb24gaXNcbiAgICAgICAgICAgICAgICAvLyBmaW5pc2hlZCBiZWZvcmUgYWRkaW5nIGRhdGEgaW50byBpdC5cbiAgICAgICAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBzdG9yZS50cmFuc2FjdGlvbjtcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjb21wbGV0ZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgY29sbGVjdGlvbiA9IG5ldyBDb2xsZWN0aW9uKHN0b3JlLCB0aGlzLmlkYik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvblF1ZXVlLmRlbGV0ZShuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjb2xsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLkRCT3BlblJlcXVlc3Qub25zdWNjZXNzID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYERCT3BlblJlcXVlc3QgJ3N1Y2Nlc3MnIGNvbGxlY3Rpb246ICR7bmFtZX0sIGNvbGxlY3Rpb25RdWV1ZToke3RoaXMuY29sbGVjdGlvblF1ZXVlLnNpemV9YCk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25RdWV1ZS5zaXplICYmIHRoaXMuREJPcGVuUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLkRCT3BlblJlcXVlc3QgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBhbGwgY29sbGVjdGlvbnMgd2VyZSBjcmVhdGVkXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbGxlY3Rpb24gKG5hbWU6IHN0cmluZyk6IFByb21pc2U8Q29sbGVjdGlvbj4ge1xuICAgICAgICBpZiAodGhpcy5pZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhuYW1lKSkge1xuICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLmlkYi50cmFuc2FjdGlvbihuYW1lKS5vYmplY3RTdG9yZShuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IENvbGxlY3Rpb24oc3RvcmUsIHRoaXMuaWRiKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiTm8gc3VjaCBjb2xsZWN0aW9uXCIpO1xuICAgIH1cbn0iLCJpbXBvcnQge0N1cnNvcn0gZnJvbSBcIi4vQ3Vyc29yXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29sbGVjdGlvbkNyZWF0ZU9wdGlvbnMge1xuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29sbGVjdGlvbkluc2VydE9uZU9wdGlvbnMge1xuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5zZXJ0T25lV3JpdGVPcFJlc3VsdCB7XG4gICAgaW5zZXJ0ZWRDb3VudDogbnVtYmVyO1xuICAgIGluc2VydGVkSWQ6IGFueTtcbn1cblxuaW50ZXJmYWNlIEluc2VydFdyaXRlT3BSZXN1bHQge1xuICAgIGluc2VydGVkQ291bnQ6IG51bWJlcjtcbiAgICBpbnNlcnRlZElkczogYW55W107XG59XG5cbmV4cG9ydCB0eXBlIEZpbHRlclF1ZXJ5PFQ+ID0ge1xuICAgIFtQIGluIGtleW9mIFRdPzogVFtQXSB8IHtcbiAgICAkZXE/OiBUW1BdO1xuICAgICRndD86IFRbUF07XG4gICAgJGd0ZT86IFRbUF07XG4gICAgJGluPzogVFtQXVtdO1xuICAgICRsdD86IFRbUF07XG4gICAgJGx0ZT86IFRbUF07XG4gICAgJG5lPzogVFtQXTtcbiAgICAkbmluPzogVFtQXVtdO1xuICAgICRhbmQ/OiAoRmlsdGVyUXVlcnk8VFtQXT4gfCBUW1BdKVtdO1xuICAgICRvcj86IChGaWx0ZXJRdWVyeTxUW1BdPiB8IFRbUF0pW107XG4gICAgJG5vdD86IChGaWx0ZXJRdWVyeTxUW1BdPiB8IFRbUF0pW10gfCBUW1BdO1xuICAgICRleHByPzogYW55O1xuICAgICRqc29uU2NoZW1hPzogYW55O1xuICAgICRtb2Q/OiBbbnVtYmVyLCBudW1iZXJdO1xuICAgICRyZWdleD86IFJlZ0V4cDtcbiAgICAkb3B0aW9ucz86IHN0cmluZztcbiAgICAkdGV4dD86IHtcbiAgICAgICAgJHNlYXJjaDogc3RyaW5nO1xuICAgICAgICAkbGFuZ3VhZ2U/OiBzdHJpbmc7XG4gICAgICAgICRjYXNlU2Vuc2l0aXZlPzogYm9vbGVhbjtcbiAgICAgICAgJGRpYWNyYXRpY1NlbnNpdGl2ZT86IGJvb2xlYW47XG4gICAgfTtcbiAgICAkd2hlcmU6IE9iamVjdDtcbiAgICAkZ2VvSW50ZXJzZWN0cz86IE9iamVjdDtcbiAgICAkZ2VvV2l0aGluPzogT2JqZWN0O1xuICAgICRuZWFyPzogT2JqZWN0O1xuICAgICRuZWFyU3BoZXJlPzogT2JqZWN0O1xuICAgICRlbGVtTWF0Y2g/OiBPYmplY3Q7XG4gICAgJHNpemU/OiBudW1iZXI7XG4gICAgJGJpdHNBbGxDbGVhcj86IE9iamVjdDtcbiAgICAkYml0c0FsbFNldD86IE9iamVjdDtcbiAgICAkYml0c0FueUNsZWFyPzogT2JqZWN0O1xuICAgICRiaXRzQW55U2V0PzogT2JqZWN0O1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn07XG59IHwgeyBba2V5OiBzdHJpbmddOiBhbnkgfTtcblxuZXhwb3J0IGNsYXNzIENvbGxlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yIChwcml2YXRlIHN0b3JlOiBJREJPYmplY3RTdG9yZSwgcHJpdmF0ZSBpZGI6IElEQkRhdGFiYXNlKSB7XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2NzXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBpbnNlcnRPbmUgKGRvY3M6IE9iamVjdCwgb3B0aW9ucz86IENvbGxlY3Rpb25JbnNlcnRPbmVPcHRpb25zKTogUHJvbWlzZTxJbnNlcnRPbmVXcml0ZU9wUmVzdWx0PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmluc2VydE1hbnkoW2RvY3NdLCBvcHRpb25zKS50aGVuKHJlcyA9PiAoe2luc2VydGVkQ291bnQgOiAxLCBpbnNlcnRlZElkIDogcmVzLmluc2VydGVkSWRzWzBdfSkpO1xuICAgIH1cblxuICAgIGluc2VydE1hbnkgKGRvY3M6IE9iamVjdFtdLCBvcHRpb25zPzogQ29sbGVjdGlvbkluc2VydE9uZU9wdGlvbnMpOiBQcm9taXNlPEluc2VydFdyaXRlT3BSZXN1bHQ+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPEluc2VydFdyaXRlT3BSZXN1bHQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGxldCBpbnNlcnRlZElkczogYW55W10gPSBbXTtcbiAgICAgICAgICAgIGxldCB0cmFuc2FjdGlvbiA9IHRoaXMuaWRiLnRyYW5zYWN0aW9uKHRoaXMuc3RvcmUubmFtZSwgXCJyZWFkd3JpdGVcIik7XG5cbiAgICAgICAgICAgIC8vIFRvIGRldGVybWluZSBpZiB0aGUgYWRkIG9wZXJhdGlvbiBoYXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSxcbiAgICAgICAgICAgIC8vIGxpc3RlbiBmb3IgdGhlIHRyYW5zYWN0aW9u4oCZcyBjb21wbGV0ZSBldmVudCBpbiBhZGRpdGlvbiB0byB0aGVcbiAgICAgICAgICAgIC8vIElEQk9iamVjdFN0b3JlLmFkZCByZXF1ZXN04oCZcyBzdWNjZXNzIGV2ZW50LFxuICAgICAgICAgICAgLy8gYmVjYXVzZSB0aGUgdHJhbnNhY3Rpb24gbWF5IHN0aWxsIGZhaWwgYWZ0ZXIgdGhlIHN1Y2Nlc3MgZXZlbnQgZmlyZXMuXG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGluc2VydGVkSWRzLmxlbmd0aCA9PT0gZG9jcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7aW5zZXJ0ZWRDb3VudCA6IGluc2VydGVkSWRzLmxlbmd0aCwgaW5zZXJ0ZWRJZHN9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBzdWNjZXNzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5vbmVycm9yID0gcmVqZWN0O1xuXG4gICAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHRoaXMuc3RvcmUubmFtZSk7XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgZG9jIG9mIGRvY3MpIHtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIGEgcmVxdWVzdCB0byBhZGQgZG9jcyBvYmplY3QgdG8gdGhlIG9iamVjdCBzdG9yZVxuICAgICAgICAgICAgICAgIGNvbnN0IG9iamVjdFN0b3JlUmVxdWVzdCA9IG9iamVjdFN0b3JlLmFkZChkb2MpO1xuXG4gICAgICAgICAgICAgICAgb2JqZWN0U3RvcmVSZXF1ZXN0Lm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgb2JqZWN0U3RvcmVSZXF1ZXN0Lm9uc3VjY2VzcyA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcmVzdWx0IG9mIGEgcmVxdWVzdCBnZW5lcmF0ZWQgZnJvbSBhIGNhbGwgdG8gYWRkKClcbiAgICAgICAgICAgICAgICAgICAgLy8gaXMgdGhlIGtleSBvZiB0aGUgdmFsdWUgdGhhdCB3YXMgYWRkZWQuXG4gICAgICAgICAgICAgICAgICAgIGluc2VydGVkSWRzLnB1c2gob2JqZWN0U3RvcmVSZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcXVlcnlbb3B0aW9uYWxdXG4gICAgICogVGhlIGZpbmQoKSBtZXRob2Qgd2l0aCBubyBwYXJhbWV0ZXJzIHJldHVybnMgYWxsIGRvY3VtZW50cyBmcm9tIGEgY29sbGVjdGlvbiBhbmQgcmV0dXJucyBhbGwgZmllbGRzIGZvciB0aGUgZG9jdW1lbnRzLlxuICAgICAqL1xuICAgIGZpbmQ8VD4gKHF1ZXJ5PzogRmlsdGVyUXVlcnk8VD4pOiBDdXJzb3I8VD4ge1xuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHRoaXMuaWRiLnRyYW5zYWN0aW9uKHRoaXMuc3RvcmUubmFtZSk7XG4gICAgICAgIGNvbnN0IG9iamVjdFN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUodGhpcy5zdG9yZS5uYW1lKTtcbiAgICAgICAgLy9UT0RPOiBwcm9jZXNzIHRoZSBxdWVyeVxuICAgICAgICAvL1RoZSBnZXRBbGwoKSBtZXRob2Qgb2YgdGhlIElEQk9iamVjdFN0b3JlIGludGVyZmFjZSByZXR1cm5zIGFuIElEQlJlcXVlc3Qgb2JqZWN0XG4gICAgICAgIC8vIGNvbnRhaW5pbmcgYWxsIG9iamVjdHMgaW4gdGhlIG9iamVjdCBzdG9yZSBtYXRjaGluZyB0aGUgc3BlY2lmaWVkIHBhcmFtZXRlciBvclxuICAgICAgICAvLyBhbGwgb2JqZWN0cyBpbiB0aGUgc3RvcmUgaWYgbm8gcGFyYW1ldGVycyBhcmUgZ2l2ZW4uXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSBvYmplY3RTdG9yZS5nZXRBbGwoKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDdXJzb3IocmVxdWVzdCk7XG4gICAgfVxufSIsImV4cG9ydCBjbGFzcyBDdXJzb3I8VD4ge1xuICAgIGNvbnN0cnVjdG9yIChwcml2YXRlIHJlcXVlc3Q6IElEQlJlcXVlc3QpIHtcblxuICAgIH1cblxuICAgIC8vIHNvcnRWYWx1ZTogc3RyaW5nO1xuICAgIC8vIHRpbWVvdXQ6IGJvb2xlYW47XG4gICAgLy8gcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlO1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI2FkZEN1cnNvckZsYWcgKi9cbiAgICAvLyBhZGRDdXJzb3JGbGFnKGZsYWc6IHN0cmluZywgdmFsdWU6IGJvb2xlYW4pOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjYWRkUXVlcnlNb2RpZmllciAqL1xuICAgIC8vIGFkZFF1ZXJ5TW9kaWZpZXIobmFtZTogc3RyaW5nLCB2YWx1ZTogYm9vbGVhbik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNiYXRjaFNpemUgKi9cbiAgICAvLyBiYXRjaFNpemUodmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNjbG9uZSAqL1xuICAgIC8vIGNsb25lKCk6IEN1cnNvcjxUPjsgLy8gc3RpbGwgcmV0dXJucyB0aGUgc2FtZSB0eXBlXG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjY2xvc2UgKi9cbiAgICAvLyBjbG9zZSgpOiBQcm9taXNlPEN1cnNvclJlc3VsdD47XG4gICAgLy8gY2xvc2UoY2FsbGJhY2s6IE1vbmdvQ2FsbGJhY2s8Q3Vyc29yUmVzdWx0Pik6IHZvaWQ7XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjY29sbGF0aW9uICovXG4gICAgLy8gY29sbGF0aW9uKHZhbHVlOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjY29tbWVudCAqL1xuICAgIC8vIGNvbW1lbnQodmFsdWU6IHN0cmluZyk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNjb3VudCAqL1xuICAgIC8vIGNvdW50KGNhbGxiYWNrOiBNb25nb0NhbGxiYWNrPG51bWJlcj4pOiB2b2lkO1xuICAgIC8vIGNvdW50KGFwcGx5U2tpcExpbWl0OiBib29sZWFuLCBjYWxsYmFjazogTW9uZ29DYWxsYmFjazxudW1iZXI+KTogdm9pZDtcbiAgICAvLyBjb3VudChvcHRpb25zOiBDdXJzb3JDb21tZW50T3B0aW9ucywgY2FsbGJhY2s6IE1vbmdvQ2FsbGJhY2s8bnVtYmVyPik6IHZvaWQ7XG4gICAgLy8gY291bnQoYXBwbHlTa2lwTGltaXQ6IGJvb2xlYW4sIG9wdGlvbnM6IEN1cnNvckNvbW1lbnRPcHRpb25zLCBjYWxsYmFjazogTW9uZ29DYWxsYmFjazxudW1iZXI+KTogdm9pZDtcbiAgICAvLyBjb3VudChhcHBseVNraXBMaW1pdD86IGJvb2xlYW4sIG9wdGlvbnM/OiBDdXJzb3JDb21tZW50T3B0aW9ucyk6IFByb21pc2U8bnVtYmVyPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNleHBsYWluICovXG4gICAgLy8gZXhwbGFpbigpOiBQcm9taXNlPEN1cnNvclJlc3VsdD47XG4gICAgLy8gZXhwbGFpbihjYWxsYmFjazogTW9uZ29DYWxsYmFjazxDdXJzb3JSZXN1bHQ+KTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNmaWx0ZXIgKi9cbiAgICAvLyBmaWx0ZXIoZmlsdGVyOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjZm9yRWFjaCAqL1xuICAgIC8vIGZvckVhY2goaXRlcmF0b3I6IEl0ZXJhdG9yQ2FsbGJhY2s8VD4sIGNhbGxiYWNrOiBFbmRDYWxsYmFjayk6IHZvaWQ7XG4gICAgLy8gZm9yRWFjaChpdGVyYXRvcjogSXRlcmF0b3JDYWxsYmFjazxUPik6IFByb21pc2U8dm9pZD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjaGFzTmV4dCAqL1xuICAgIC8vIGhhc05leHQoKTogUHJvbWlzZTxib29sZWFuPjtcbiAgICAvLyBoYXNOZXh0KGNhbGxiYWNrOiBNb25nb0NhbGxiYWNrPGJvb2xlYW4+KTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNoaW50ICovXG4gICAgLy8gaGludChoaW50OiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjaXNDbG9zZWQgKi9cbiAgICAvLyBpc0Nsb3NlZCgpOiBib29sZWFuO1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI2xpbWl0ICovXG4gICAgLy8gbGltaXQodmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNtYXAgKi9cbiAgICAvLyBtYXA8VT4odHJhbnNmb3JtOiAoZG9jdW1lbnQ6IFQpID0+IFUpOiBDdXJzb3I8VT47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbWF4ICovXG4gICAgLy8gbWF4KG1heDogbnVtYmVyKTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI21heEF3YWl0VGltZU1TICovXG4gICAgLy8gbWF4QXdhaXRUaW1lTVModmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNtYXhTY2FuICovXG4gICAgLy8gbWF4U2NhbihtYXhTY2FuOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbWF4VGltZU1TICovXG4gICAgLy8gbWF4VGltZU1TKHZhbHVlOiBudW1iZXIpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbWluICovXG4gICAgLy8gbWluKG1pbjogbnVtYmVyKTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI25leHQgKi9cbiAgICAvLyBuZXh0KCk6IFByb21pc2U8VCB8IG51bGw+O1xuICAgIC8vIG5leHQoY2FsbGJhY2s6IE1vbmdvQ2FsbGJhY2s8VCB8IG51bGw+KTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNwcm9qZWN0ICovXG4gICAgLy8gcHJvamVjdCh2YWx1ZTogT2JqZWN0KTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI3JlYWQgKi9cbiAgICAvLyByZWFkKHNpemU6IG51bWJlcik6IHN0cmluZyB8IEJ1ZmZlciB8IHZvaWQ7XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjbmV4dCAqL1xuICAgIC8vIHJldHVybktleShyZXR1cm5LZXk6IE9iamVjdCk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNyZXdpbmQgKi9cbiAgICAvLyByZXdpbmQoKTogdm9pZDtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzZXRDdXJzb3JPcHRpb24gKi9cbiAgICAvLyBzZXRDdXJzb3JPcHRpb24oZmllbGQ6IHN0cmluZywgdmFsdWU6IE9iamVjdCk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzZXRSZWFkUHJlZmVyZW5jZSAqL1xuICAgIC8vIHNldFJlYWRQcmVmZXJlbmNlKHJlYWRQcmVmZXJlbmNlOiBzdHJpbmcgfCBSZWFkUHJlZmVyZW5jZSk6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzaG93UmVjb3JkSWQgKi9cbiAgICAvLyBzaG93UmVjb3JkSWQoc2hvd1JlY29yZElkOiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjc2tpcCAqL1xuICAgIC8vIHNraXAodmFsdWU6IG51bWJlcik6IEN1cnNvcjxUPjtcbiAgICAvLyAvKiogaHR0cDovL21vbmdvZGIuZ2l0aHViLmlvL25vZGUtbW9uZ29kYi1uYXRpdmUvMy4xL2FwaS9DdXJzb3IuaHRtbCNzbmFwc2hvdCAqL1xuICAgIC8vIHNuYXBzaG90KHNuYXBzaG90OiBPYmplY3QpOiBDdXJzb3I8VD47XG4gICAgLy8gLyoqIGh0dHA6Ly9tb25nb2RiLmdpdGh1Yi5pby9ub2RlLW1vbmdvZGItbmF0aXZlLzMuMS9hcGkvQ3Vyc29yLmh0bWwjc29ydCAqL1xuICAgIC8vIHNvcnQoa2V5T3JMaXN0OiBzdHJpbmcgfCBPYmplY3RbXSB8IE9iamVjdCwgZGlyZWN0aW9uPzogbnVtYmVyKTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI3N0cmVhbSAqL1xuICAgIC8vIHN0cmVhbShvcHRpb25zPzogeyB0cmFuc2Zvcm0/OiBGdW5jdGlvbiB9KTogQ3Vyc29yPFQ+O1xuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI3RvQXJyYXkgKi9cbiAgICB0b0FycmF5ICgpOiBQcm9taXNlPFRbXT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8VFtdPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3Qub25lcnJvciA9IHJlamVjdDtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdC5vbnN1Y2Nlc3MgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBEbyBzb21ldGhpbmcgd2l0aCB0aGUgcmVxdWVzdC5yZXN1bHQhXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIC8qKiBodHRwOi8vbW9uZ29kYi5naXRodWIuaW8vbm9kZS1tb25nb2RiLW5hdGl2ZS8zLjEvYXBpL0N1cnNvci5odG1sI3Vuc2hpZnQgKi9cbiAgICAvLyB1bnNoaWZ0KHN0cmVhbTogQnVmZmVyIHwgc3RyaW5nKTogdm9pZDtcbn0iXSwic291cmNlUm9vdCI6IiJ9